
\documentclass[12pt]{article}
\usepackage{amssymb}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsmath}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{multicol}
\usepackage{color}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{textcomp}
\definecolor{listinggray}{gray}{0.9}
\definecolor{lbcolor}{rgb}{0.9,0.9,0.9}
\lstset{
%	backgroundcolor=\color{lbcolor},
        language=Mathematica,
	tabsize=2,
	rulecolor=,
        basicstyle=\scriptsize,
        upquote=true,
%        aboveskip={1.5\baselineskip},
        columns=fixed,
        showstringspaces=false,
        extendedchars=true,
%        breaklines=true,
        prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
%        frame=single,
        showtabs=false,
        showspaces=false,
        showstringspaces=false,
        identifierstyle=\ttfamily,
        keywordstyle=\color[rgb]{0,0,1},
        commentstyle=\color[rgb]{0.133,0.545,0.133},
        stringstyle=\color[rgb]{0.627,0.126,0.941},
}


\newtheorem{statement}{Statement}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}{Lemma}
\newtheorem{mynote}{Note}[section]
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}
\newcommand{\go}{\stackrel{\circ }{\mathfrak{g}}}
\newcommand{\ao}{\stackrel{\circ }{\mathfrak{a}}}
\newcommand{\co}[1]{\stackrel{\circ }{#1}}
\newcommand{\pia}{\pi_{\mathfrak{a}}}
\newcommand{\piab}{\pi_{\mathfrak{a}_{\bot}}}
\newcommand{\gf}{\mathfrak{g}}
\newcommand{\af}{\mathfrak{a}}
\newcommand{\aft}{\widetilde{\mathfrak{a}}}
\newcommand{\afb}{\mathfrak{a}_{\bot}}
\newcommand{\hf}{\mathfrak{h}}
\newcommand{\hfb}{\mathfrak{h}_{\bot}}
\newcommand{\pf}{\mathfrak{p}}
%\input{tcilatex}

\begin{document}

\title{{\bf Affine.m} -- {\it Mathematica} package for Lie algebras of finite, affine and extended affine type}
\author{A A Nazarov$^{1,2}$\\
{\small $^1$ Theoretical Department, SPb State University}\\
{\small 198904, Sankt-Petersburg, Russia}\\
{\small$^{2}$ Chebyshev Laboratory,}\\
{\small Department of Mathematics and Mechanics, SPb State University}\\
{\small 199178, Saint-Petersburg, Russia}\\
{\small email: antonnaz@gmail.com}}

\maketitle

\begin{abstract}
  We present {\it Mathematica} package for computations in the representation theory of Lie algebras of finite, affine and extended affine types. 
\end{abstract}

{\footnotesize
\section*{Program summary}
\textit{Title of program:} Affine.m
\\
\textit{Catalogue identifier:}
\\
\textit{Program obtainable from:} (submitted to Computer Physics Communications) \\
%CPC Program Library, Queen's University of Belfast, N. Ireland. Also from
\mbox{}\qquad \texttt{http://github.com/naa/Articles/AffineLieAlgebras/Mathematica/}
\\
\textit{Reference in CPC to previous version:} 
\\
\textit{Catalogue identifier of previous version:}
\\
\textit{Does the new version supersede the original program?:}
\\
\textit{Computers:} Any computer running Mathematica
\\
\textit{Operating systems under which the new version has been
tested:} Linux, Unix, Windows XP, MacOS
\\
\textit{Programming language:} Mathematica (version 7.0 or higher)
\\
\textit{Memory required to execute with typical data:} 20 Mbyte
\\
\textit{No. of bits in a word:} 64 or 32
\\
\textit{No. of processors used:} 1
\\
\textit{No. of bytes in distributed program, including test data,
etc.:} 0.15 Mbyte
\\
\textit{Distribution format:} Unencoded compressed tar file
\\
\textit{Nature of physical problem:} 
TODO: Finite dimensional Lie algebras are important for physics. Affine for CFT/

Symmetry has been a very important fundamental principle under-
lying human knowledge about our physical world. Among several
mathematical formulations of symmetry, the Lie algebras and their
corresponding Lie groups are probably the ones most explored.
They were discovered by Sophus Lie and Wilhelm Killing during
the last two decades of the 19th century. Lie’s work on Lie groups
was inspired by Galois’ work in 1832 in which he discovered the
ﬁnite groups. Independently, Killing had started a classiﬁcation of
Lie groups which was the starting point to the Élie Cartan’s doctoral
thesis in the beginning at the 20th century. Cartan was able to make
a complete classiﬁcation of Lie groups. Since Cartan’s classiﬁca-
tion, the theory of Lie groups has been utilized in many branches
of physics, including molecular physics, atomic physics, nuclear
physics and particle physics.
\\
\textit{Method of solution:} The Butler-Portugal algorithm.
\\
\textit{Restrictions on the complexity of the problem:}
Calculations up to finite grade
\\
\textit{Typical running time:} A few seconds with generic expressions

%
}

\section{Introduction}

Representation theory of finite, affine and extended affine Lie algebras is of central importance for different areas of mathematical and theoretical physics. Simple Lie algebras appear as the symmetries of classical and quantum systems, e.g. of gauge quantum field theories. Tensor product decomposition problem for simple Lie algebras appears in classification of particles, branching problem -- in the study of symmetry breaking, for example in great unification models. 

Example.

Major role of representation theory for the study of quantum and classical integrable systems is well known. Here, for example, tensor product decomposition is required for the computation of spectra and eigenstates of Hamiltonian. Quantum deformation of simple Lie algebras appears naturally in the study of integrable systems. It is possible to introduce $q$-analogues of multiplicities and branching coefficients. 

Definition.

Example.

Affine Lie algebras, WZW and coset models. Denominator identity 



Multiplicities, branching and tensor product problems are essentially different faces of the same problem. One possible solution is recurrent computation from corresponding generalization of Weyl character formula. Such a solution is applicable in many cases. For example if $q$ is not root of unity category of $U_{q}(\gf)$-modules is equivalent to the non-deformed case.  Since Weyl character formula is preserved by $q$-deformation in this case, recurrent approach is applicable to quantum groups. etc.

General recurrent relations for branching coefficients of non-maximal embeddings were proposed in \cite{2010arXiv1007.0318L}. In \cite{2011arXiv1102.1702L} it was shown that these relations demonstrate the connection of branching problem with BGG resolution. Also it was noticed, that weight multiplicities and tensor product decomposition coefficients can be obtained in the special cases of Lie algebra embeddings ($\hf\subset\gf$ and $\gf\subset\gf\otimes\gf$ correspondingly).

Example.

In this paper we present {\it Mathematica} package for computations in representation theory of affine Lie algebras. 

Main features:
\begin{itemize}
\item Root systems, fundamental weights, Weyl reflections for finite dimensional and affine semi-simple Lie algebras.
\item Recurrent calculation of weight multiplicities and branching coefficients for irreducible representations.
\item Construction of closed algebraic expressions for string and branching functions for low-rank affine Lie algebras.
\end{itemize}

For (1) we use fairly standard algorithms. For simple finite-dimensional Lie algebras these algorithms were already implemented in several software packages (\cite{vanleeuwen1994lsp}, \cite{stembridge2001computational}, \cite{fischbacher2002ilp}, \cite{simplie}). We have made them available to the users of popular computer algebra system {\it Mathematica}. Flexibility of {\it Mathematica} language has allowed us to represent Weyl group elements in the form convenient for simplification with rules []. 

There exists well-known fast recursive formula for recurrent computation of weight multiplicities of Freudenthal \cite{moody1982fast}. It is used in most software packages (\cite{vanleeuwen1994lsp}, \cite{stembridge2001computational}, \cite{fischbacher2002ilp}). We present our own implementation. Also we present another recurrent computation routine based on general approach to branching [1007]. In case of finite-dimensional Lie algebras this procedure is equivalent to Racah formula, which is faster for weight multiplicities in case of low rank algebras and big representations. (See the table with run times). 

Branching and tensor-product decomposition is carried out by the same recurrent process, which is implemented for arbitrary pair of algebra $\gf$ and subalgebra $\af$. 

For tensor product decompositions it is sometimes possible to give close algebraic answer for arbitrary tensor powers (see [Lyakhovsky, Postnova]). This formulae are also included in our package.

\section{Core algorithms and data structures}
\label{sec:core-algorithms}

Consider Lie algebra $\gf$ of finite or affine type. We denote its Cartan subalgebra by $\hf$ and root system by $\Delta$. Roots $\alpha_i\in \Delta$ and weights $\mu,\nu\in \hf^*$ of the algebra are represented by the data-structures \lstinline{finiteWeight} and \lstinline{affineWeight} of {\it Affine.m} package. 
Root system can be reconstructed from the set of simple roots $\alpha_{1}, \dots, \alpha_{r}$, where $r$ is the rank of the algebra, by the action of Weyl group $W_{\gf}$.  

The set of simple roots can be created using different methods. The coordinates of simple roots can be entered by hand, for example direct sum $sl_{2}\oplus sl_{2}$ can be constructed by the code
\begin{lstlisting}
  makeFiniteRootSystem[{{1,0}, {0,1}}]
\end{lstlisting}
For simple finite-dimensional Lie algebras there are built-in constructors
\begin{lstlisting}
  b2=makeSimpleRootSystem[B,2]

  Out[6]= finiteRootSystem[2, 2, {finiteWeight[2, {1, -1}], finiteWeight[2, {0, 1}]}]
\end{lstlisting}

It is possible to specify direct sum of algebras:
\begin{lstlisting}
  b2+b2

  Out[6]= finiteRootSystem[4, 4, {finiteWeight[4, {1, -1, 0, 0}], finiteWeight[2, {0, 1}]}]
\end{lstlisting}

Weights can be specified by coordinates in standard basis or by Dynkin labels. The latter way is preferable. 
\begin{lstlisting}
  makeFiniteWeight[{1,0}]

  weight[b2][1,1]

  weight[b2a][1,0,1]
\end{lstlisting}

Addition, multiplication by number and scalar product are defined for roots and weights:
\begin{lstlisting}
  makeFiniteWeight[{1,1}]+2*makeFiniteWeight[{1,-1}]

  Out[7]=finiteWeight[2, {3, -1}]
\end{lstlisting}

It is possible to compute Cartan matrix or draw Dynkin diagram of the algebra or specify an algebra with Cartan matrix or Dynkin diagram. TODO

Action of Weyl group $W_{\gf}$ generated by simple reflections $s_{\alpha}, \alpha\in \Delta$ is important for computations. We denote by $C_{\gf}\subset \hf^*$ the main Weyl chamber (fundamental domain for the action of $W_{\gf}$) and its closure by $\bar C_{\gf}$. In many computations it is possible to work inside the main Weyl chamber due to Weyl symmetry. 

Sometimes it can be helpful to consider Weyl group elements abstractly withouth the reference to root system. For example, there exists package for rule-based simplification of Weyl group elements based on finite automata [cite!]. We offer the function \lstinline{weylGroupElement[x__Integer][rs_?rootSystemQ]} which produces the object, representing element of Weyl group encoded by the set of reflections, that can act upon the weights. It can be used as follows:
\begin{lstlisting}
  <<simplification.m;
  (weylGroupElement @@ simplify[s[1,2,3,1,3,1,2,1,4,2,1]])[b2+b2][makeFiniteWeight[{1,1,0,0}]]

  Out[7]= finiteWeight[4, {-1, 1, 0, 0}]
\end{lstlisting}


Following functions can be used to compute objects related to Weyl group and its action on roots and weights
 \begin{itemize}
 \item   $\forall \mu\in \hf^* \exists \lambda\in \bar C_{\gf}, w\in W_{\gf}: \mu=w \lambda$, the function \lstinline{toFundamentalChamber} can be used to find such $\lambda$.
 \item Orbit of weight under the action of Weyl group is computed with the function \lstinline{orbit}, the elements of the orbit are grouped by the length of Weyl group element.
 \end{itemize}

\subsection{Representation theory}
\label{sec:repr-theory}

Weights of the irreducible highest weight representation are calculated using the function \lstinline{weightSystem}
\begin{lstlisting}
  weightSystem[b2][fundamentalWeights[b2][[1]]*2]
\end{lstlisting}


\section{Examples}
\label{sec:examples}

\subsection{Finite-dimensional Lie algebras}
\label{sec:finite-dimens-lie}

Consider the algebra $B_{4}$ and regular subalgebra $B_{2}$. This embedding can be specified by the following code:
\begin{equation}
  \label{eq:1}
  B_{2}\subset B_{4}
\end{equation}

Branching coefficients can be calculated using the formula () with the code:
\begin{equation}
  \label{eq:2}
  calculate_{branching}
\end{equation}

It is interesting to note that the subalgebra $\afb$ is equal to $B_{2}$ in this case and not to $A_{1}$ as it can be thought from the Dynkin diagram. To visualize the diagrams and branching coefficients the following instructions were used:
\begin{equation}
  \label{eq:3}
  plot
\end{equation}
\section{Conclusion}
\label{sec:conclusion}



\bibliography{bibliography}{}
\bibliographystyle{utphys}


\end{document}
